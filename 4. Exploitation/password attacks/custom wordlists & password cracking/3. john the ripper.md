[John the Ripper](https://github.com/openwall/john) (aka. `JtR` aka. `john`) is a well-known penetration testing tool used for cracking passwords through various attacks including brute-force and dictionary.
The `"jumbo"` variant is recommended for our uses, as it has performance optimizations, additional features such as multilingual word lists, and support for 64-bit architectures.

# CHEATSHEET

single crack mode ( for linux `passwd` like files)
```
$ john --single passwd
```

crack password hashes with wordlist
```
john --format <md5> --wordlist=<rockyou.txt>
```

john incremental mode
```

```
(undocumented)

search for john2X tools
```
$ locate *2john*
```

cracking zip archives
```
$ zip2john ZIP.zip > zip.hash
cat zip.hash 
```

cracking bitlocker encrypted drives

```shell-session
$ bitlocker2john -i Backup.vhd > backup.hashes # output: 4 hashes we select 1  
 
 grep "bitlocker\$0" backup.hashes > backup.hash  # select first hash of 4

$ hashcat -a 0 -m 22100 '$bitlocker$0$4f<snip>8576$12$00b' /usr/share/wordlists/rockyou.txt
```

# Complete the cheetsheet ========

## Cracking modes

#### Single crack mode

`Single crack mode` is a rule-based cracking technique that is most useful when targeting Linux credentials. It generates password candidates based on the victim's username, home directory name, and [GECOS](https://en.wikipedia.org/wiki/Gecos_field) values (full name, room number, phone number, etc.). These strings are run against a large set of rules that apply common string modifications seen in passwords (e.g. a user whose real name is `Bob Smith` might use `Smith1` as their password).

Imagine we as attackers came across the file `passwd` with the following contents:

```
r0lf:$6$ues25dIanlctrWxg$nZHVz2z4kCy1760Ee28M1xtHdGoy0C2cYzZ8l2sVa1kIa8K9gAcdBP.GI6ng/qA4oaMrgElZ1Cb9OeXO4Fvy3/:0:0:Rolf Sebastian:/home/r0lf:/bin/bash
```

Based on the contents of the file, it can be inferred that the victim has the username `r0lf`, the real name `Rolf Sebastian`, and the home directory `/home/r0lf`. Single crack mode will use this information to generate candidate passwords and test them against the hash. We can run the attack with the following command:

```shell-session
$ john --single passwd
Press 'q' or Ctrl-C to abort, almost any other key for status
[...SNIP...]        (r0lf)     
1g 0:00:00:00 DONE 1/3 (2025-04-10 07:47) 12.50g/
```
with wordlist:
```shell-session
$ john --wordlist=<wordlist_file> <hash_file>
```
. Multiple wordlists can be specified by separating them with a comma. Rules, either custom or built-in, can be specified by using the `--rules` argument. These can be applied to generate candidate passwords using transformations such as appending numbers, capitalizing letters and adding special characters.


## Incremental mode
`Incremental mode` is a powerful, brute-force-style password cracking mode that generates candidate passwords based on a statistical model ([Markov chains](https://en.wikipedia.org/wiki/Markov_chain)). It is designed to test all character combinations defined by a specific character set, prioritizing more likely passwords based on training data.

By default, JtR uses predefined incremental modes specified in its configuration file (`john.conf`), which define character sets and password lengths. You can customize these or define your own to target passwords that use special characters or specific patterns.
![](Pasted%20image%2020250619165640.png)
## Identifying hash formats
ometimes, password hashes may appear in an unknown format, and even John the Ripper (JtR) may not be able to identify them with complete certainty.

One way to get an idea is to consult [JtR's sample hash documentation](https://openwall.info/wiki/john/sample-hashes), or [this list by PentestMonkey](https://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats). Both sources list multiple example hashes as well as the corresponding JtR format. Another option is to use a tool like [hashID](https://github.com/psypanda/hashID), which checks supplied hashes against a built-in list to suggest potential formats.

## hashID
By adding the `-j` flag, hashID will, in addition to the hash format, list the corresponding JtR format:
```shell
$ hashid -j 193069ceb0461e1d40d216e32c79c704
Analyzing '193069ceb0461e1d40d216e32c79c704'
[+] MD2 [JtR Format: md2]
[+] MD5 [JtR Format: raw-md5]
[+] MD4 [JtR Format: raw-md4]
[+] Double MD5 
[+] LM [JtR Format: lm]
[+] RIPEMD-128 [JtR Format: ripemd-128]
```
Unfortunately, in our example it is still quite unclear what format the hash is in.
This is simply one of the "problems" you will encounter as a pentester.

**the context of where the hash came from will be enough to make an educated case on the format. In this specific example, the hash format is RIPEMD-128.**

## john hash formats
JtR supports hundreds of hash formats, some of which are listed in the table below. The `--format` argument can be supplied to instruct JtR which format target hashes have.

```
john --format <format>
```


## Cracking files

It is also possible to crack password-protected or encrypted files with JtR. Multiple `"2john"` tools come with JtR that can be used to process files and produce hashes compatible with JtR. The generalized syntax for these tools is:

```shell-session
$ <convert-tool john2x> <file_to_crack> > file.hash
```

list conversion tools
```
$ locate *2john*
```

| t**ool**        | **Description**                       |
| --------------- | ------------------------------------- |
| `pdf2john`      | Converts PDF documents for John       |
| `ssh2john`      | Converts SSH private keys for John    |
| `mscash2john`   | Converts MS Cash hashes for John      |
| `keychain2john` | Converts OS X keychain files for John |
`<snip>`
## john hash formats

|**Hash format**|**Example command**|**Description**|
|---|---|---|
|afs|`john --format=afs [...] <hash_file>`|AFS (Andrew File System) password hashes|
|bfegg|`john --format=bfegg [...] <hash_file>`|bfegg hashes used in Eggdrop IRC bots|
|bf|`john --format=bf [...] <hash_file>`|Blowfish-based crypt(3) hashes|
|bsdi|`john --format=bsdi [...] <hash_file>`|BSDi crypt(3) hashes|
|crypt(3)|`john --format=crypt [...] <hash_file>`|Traditional Unix crypt(3) hashes|
|des|`john --format=des [...] <hash_file>`|Traditional DES-based crypt(3) hashes|
|dmd5|`john --format=dmd5 [...] <hash_file>`|DMD5 (Dragonfly BSD MD5) password hashes|
|dominosec|`john --format=dominosec [...] <hash_file>`|IBM Lotus Domino 6/7 password hashes|
|EPiServer SID hashes|`john --format=episerver [...] <hash_file>`|EPiServer SID (Security Identifier) password hashes|
|hdaa|`john --format=hdaa [...] <hash_file>`|hdaa password hashes used in Openwall GNU/Linux|
|hmac-md5|`john --format=hmac-md5 [...] <hash_file>`|hmac-md5 password hashes|
|hmailserver|`john --format=hmailserver [...] <hash_file>`|hmailserver password hashes|
|ipb2|`john --format=ipb2 [...] <hash_file>`|Invision Power Board 2 password hashes|
|krb4|`john --format=krb4 [...] <hash_file>`|Kerberos 4 password hashes|
|krb5|`john --format=krb5 [...] <hash_file>`|Kerberos 5 password hashes|
|LM|`john --format=LM [...] <hash_file>`|LM (Lan Manager) password hashes|
|lotus5|`john --format=lotus5 [...] <hash_file>`|Lotus Notes/Domino 5 password hashes|
|mscash|`john --format=mscash [...] <hash_file>`|MS Cache password hashes|
|mscash2|`john --format=mscash2 [...] <hash_file>`|MS Cache v2 password hashes|
|mschapv2|`john --format=mschapv2 [...] <hash_file>`|MS CHAP v2 password hashes|
|mskrb5|`john --format=mskrb5 [...] <hash_file>`|MS Kerberos 5 password hashes|
|mssql05|`john --format=mssql05 [...] <hash_file>`|MS SQL 2005 password hashes|
|mssql|`john --format=mssql [...] <hash_file>`|MS SQL password hashes|
|mysql-fast|`john --format=mysql-fast [...] <hash_file>`|MySQL fast password hashes|
|mysql|`john --format=mysql [...] <hash_file>`|MySQL password hashes|
|mysql-sha1|`john --format=mysql-sha1 [...] <hash_file>`|MySQL SHA1 password hashes|
|NETLM|`john --format=netlm [...] <hash_file>`|NETLM (NT LAN Manager) password hashes|
|NETLMv2|`john --format=netlmv2 [...] <hash_file>`|NETLMv2 (NT LAN Manager version 2) password hashes|
|NETNTLM|`john --format=netntlm [...] <hash_file>`|NETNTLM (NT LAN Manager) password hashes|
|NETNTLMv2|`john --format=netntlmv2 [...] <hash_file>`|NETNTLMv2 (NT LAN Manager version 2) password hashes|
|NEThalfLM|`john --format=nethalflm [...] <hash_file>`|NEThalfLM (NT LAN Manager) password hashes|
|md5ns|`john --format=md5ns [...] <hash_file>`|md5ns (MD5 namespace) password hashes|
|nsldap|`john --format=nsldap [...] <hash_file>`|nsldap (OpenLDAP SHA) password hashes|
|ssha|`john --format=ssha [...] <hash_file>`|ssha (Salted SHA) password hashes|
|NT|`john --format=nt [...] <hash_file>`|NT (Windows NT) password hashes|
|openssha|`john --format=openssha [...] <hash_file>`|OPENSSH private key password hashes|
|oracle11|`john --format=oracle11 [...] <hash_file>`|Oracle 11 password hashes|
|oracle|`john --format=oracle [...] <hash_file>`|Oracle password hashes|
|pdf|`john --format=pdf [...] <hash_file>`|PDF (Portable Document Format) password hashes|
|phpass-md5|`john --format=phpass-md5 [...] <hash_file>`|PHPass-MD5 (Portable PHP password hashing framework) password hashes|
|phps|`john --format=phps [...] <hash_file>`|PHPS password hashes|
|pix-md5|`john --format=pix-md5 [...] <hash_file>`|Cisco PIX MD5 password hashes|
|po|`john --format=po [...] <hash_file>`|Po (Sybase SQL Anywhere) password hashes|
|rar|`john --format=rar [...] <hash_file>`|RAR (WinRAR) password hashes|
|raw-md4|`john --format=raw-md4 [...] <hash_file>`|Raw MD4 password hashes|
|raw-md5|`john --format=raw-md5 [...] <hash_file>`|Raw MD5 password hashes|
|raw-md5-unicode|`john --format=raw-md5-unicode [...] <hash_file>`|Raw MD5 Unicode password hashes|
|raw-sha1|`john --format=raw-sha1 [...] <hash_file>`|Raw SHA1 password hashes|
|raw-sha224|`john --format=raw-sha224 [...] <hash_file>`|Raw SHA224 password hashes|
|raw-sha256|`john --format=raw-sha256 [...] <hash_file>`|Raw SHA256 password hashes|
|raw-sha384|`john --format=raw-sha384 [...] <hash_file>`|Raw SHA384 password hashes|
|raw-sha512|`john --format=raw-sha512 [...] <hash_file>`|Raw SHA512 password hashes|
|salted-sha|`john --format=salted-sha [...] <hash_file>`|Salted SHA password hashes|
|sapb|`john --format=sapb [...] <hash_file>`|SAP CODVN B (BCODE) password hashes|
|sapg|`john --format=sapg [...] <hash_file>`|SAP CODVN G (PASSCODE) password hashes|
|sha1-gen|`john --format=sha1-gen [...] <hash_file>`|Generic SHA1 password hashes|
|skey|`john --format=skey [...] <hash_file>`|S/Key (One-time password) hashes|
|ssh|`john --format=ssh [...] <hash_file>`|SSH (Secure Shell) password hashes|
|sybasease|`john --format=sybasease [...] <hash_file>`|Sybase ASE password hashes|
|xsha|`john --format=xsha [...] <hash_file>`|xsha (Extended SHA) password hashes|
|zip|`john --format=zip [...] <hash_file>`|ZIP (WinZip) password hashes|