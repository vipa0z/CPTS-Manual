
Many orgs require periodic password changes, which often leads to predictable patterns (e.g., `Summer2023` → `Summer2023!` → `Summer2024`). We exploit these patterns using targeted word-lists, 
## Common Patterns
| **Description**                       | **Example**         |
| ------------------------------------- | ------------------- |
| First letter uppercase                | `Password`          |
| Adding numbers                        | `Password123`       |
| Adding year                           | `Password2022`      |
| Adding month                          | `Password02`        |
| Last char = `!`                       | `Password2022!`     |
| Adding special chars                  | `Password@123`      |

---

### 1) base wordlist
```bash
seclists/Passwords/darkweb2017_top-10000.txt
```
*Fetch a public “top passwords” list for a quick starting point.*

---
### 3) CeWL: targeted wordlist from a site
```bash
cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist
wc -l inlane.wordlist
```
*Spider a target website to extract likely words (depth 4, min length 6).*

---

### 4) Cuppy: OSINT-driven user profile wordlist
```bash
cuppy -i
# fill in personal info (name, DOB, company, pets, hobbies, etc.)
wc -l mark.txt
```
*Generate a customized wordlist from gathered intel.*
### 2) Filter with `grep` to match policy (example: ≥8 chars, upper, lower, number)
```bash
grep -E '^.{8,}$' darkweb2017_top-10000.txt > darkweb2017-minlength.txt
```
*Keep only passwords with length ≥ 8.*

```bash
grep -E '[A-Z]' darkweb2017-minlength.txt > darkweb2017-uppercase.txt
```
*Require at least one uppercase letter.*

```bash
grep -E '[a-z]' darkweb2017-uppercase.txt > darkweb2017-lowercase.txt
```
*Require at least one lowercase letter.*

```bash
grep -E '[0-9]' darkweb2017-lowercase.txt > darkweb2017-number.txt
```
*Require at least one numeric digit.*

```bash
wc -l darkweb2017-number.txt
```
*Count remaining candidates after filtering.*

---

### 5) Hashcat rule basics (quick reference)
| Rule | Meaning | Example |
|------|---------|---------|
| `:`  | No change | `password → password` |
| `l`  | Lowercase all | `PASS → pass` |
| `u`  | Uppercase all | `pass → PASS` |
| `c`  | Capitalize first, rest lower | `summer → Summer` |
| `t`  | Toggle case | `p@ssW0rd → P@SSw0RD` |
| `sXY`| Replace `X` with `Y` | `sa@` turns `a`→`@` |
| `$!` | Append symbol `!` | `Pass → Pass!` |
| `$1$9$9$8` | Append `1998` | `Pass → Pass1998` |


Each rule is written on a new line and determines how a given word should be transformed. If we write the functions shown above into a file, it may look like this:


```shell-session
cat custom.rule

:
c
so0
c so0
sa@
c sa@
c sa@ so0
$!
$! c
$! so0
$! sa@
$! c so0
$! c sa@
$! so0 sa@
$! c so0 sa@
```
---

### 6) Example `custom.rule` (broad but focused)
```text
# Simple caps + year + symbol
c $1$9$9$8$!
c $1$9$9$8$#
c $1$9$9$8$@

# Toggle case + year + symbol
t $1$9$9$8$!
t $1$9$9$8$#

# Leetspeak variants + year + symbol
c sa@ $1$9$9$8$!    # a -> @
c se3 $1$9$9$8$!    # e -> 3
c si1 $1$9$9$8$!    # i -> 1
c so0 $1$9$9$8$!    # o -> 0
```
*Focus on realistic corporate “complexity” habits: caps, year, symbol, basic leet.*

> **Rule line decoding examples**  
> - `c $1$9$9$8$@` → Capitalize, then append `1998@` (`Nexura` → `Nexura1998@`).  
> - `c $!$1$9$9$8` → Capitalize, then append `!1998` (`abdo` → `Abdo!1998`).  
> - `t $1$9$9$8$#` → Toggle case, then append `1998#`.

---

### 7) Expand words with rules (no cracking yet)
```bash
hashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list
wc -l mut_password.list
```
*Apply rules to grow candidates; `--stdout` prints candidates, not cracking.*

---

### 8) Filter for a stricter policy (example: ≥12 chars, likely capitalization)
```bash
cat mut_password.list \
  | grep -E '^.{12,}$' \
  | grep -E '[A-Z]+[a-z]+' \
  | sort -u > 12ormore.txt
wc -l 12ormore.txt
```
*Reduce noise by enforcing policy-aligned patterns.*

> Optional shape check:  
> ```bash
> head -n 50 12ormore.txt
> ```
> *Sanity-check that candidates match expectations.*

---

### 10) Key takeaways
- **OSINT is leverage:** Use context (names, pets, years) + website terms (CeWL).  
- **Users are predictable:** Capitalization + year + symbol dominates many policies.  
- **Filter aggressively:** Enforce policy early to speed up cracking.  
- **Rules are the engine:** Keep them realistic and targeted to reduce bloat.

