`Simple Network Management Protocol` ([SNMP](https://datatracker.ietf.org/doc/html/rfc1157)) is a protocol for monitoring and managing network devices. In addition, configuration tasks can be handled, and settings can be made remotely. SNMP-enabled hardware includes routers, switches, servers, IoT devices, and many other devices that can also be queried and controlled using this standard protocol.
#### what information can be pulled from SNMP?

- Email addresses
- SNMP community strings
- Password hashes
- Clear text passwords
- system OS info

#### latest versions and their security features:
- `SNMPv3`: username and password auth. uses encryption for transmission, complex setup
- `snmpv2c`: uses community strings, transmission is in cleartext
- `snmpv1`: no built-in authentication
- known strings: `public`, `private` `seclist's snmp.txt`
- Often, when certain community strings are bound to specific IP addresses, they are named with the hostname of the host,
### tools:
- 1 **onesixtyone** â†’ find community strings (password discovery).
- 2 **snmpwalk** â†’ enumerate data once you have a valid string.
-  3 **braa** â†’  given community string, blast many OIDs across many hosts, useful for mass discovery with a known string. (messier than snmpwalk)
### bruteforcing community strings
```shell-session
onesixtyone -c /opt/useful/seclists/Discovery/SNMP/snmp.txt 10.129.14.128

[<string>]
```

#### situations where you onesixty failed
 First: discover a valid string/Pattern, Then use crunch to generate a wordlist and bruteforce with onesixtyone
### bruteforce community strings with braa
```shell-session
braa <community string>@<IP>:.1.3.6.*
	```
### querying SNMP data from a device ( dump all mib table)
```shell-session
snmpwalk -v2c -c public 10.129.14.128
```

### from rapid7 blog:
gather all snmp data
```
smbpbw.pl $ip string timeout threads

smbpbw.pl $ip public 2 32
smbpbw.pl $ip <community-string> 2 32
```


extract the sysDesc data from each file to determine what devices I have harvested information from.
```msf
grep ".1.3.6.1.2.1.1.1.0" *.snmp
```

### identify other  community strings via the trap data:
discover other hosts
```msf
grep -i "trap" *.snmp
```
use this to further access to other hosts
![[Pasted image 20250903155154.png]]
### find passwords in logs
some devices log failed login attempts in MIB tables
```msf
grep -i "fail" *.snmp
```
![[Pasted image 20250903155423.png]]
It is also important to note that these logs are usually short and they end up rolling over quickly, so make sure you get a copy before launching any brute force attacks against the device. If not, you may end up with SNMP MIB extraction data that looks like the logs in Figure 5:

![to_late.png](https://www.rapid7.com/cdn/assets/blte86e48c0836119e7/683de0d2bc38b1254d477cf4/to_late.png)

---
### Concepts behind SNMP PROTOCL

#### Community Strings
Community strings can be seen as passwords that are used to determine whether the requested information can be viewed or not. many organizations are still using `SNMPv2`, as the transition to `SNMPv3` can be very complex, but the services still need to remain active.



## Misconfigurations
Some dangerous settings that the administrator can make with SNMP are:

|**Settings**|**Description**|
|---|---|
|`rwuser noauth`|Provides access to the full OID tree without authentication.|
|`rwcommunity <community string> <IPv4 address>`|Provides access to the full OID tree regardless of where the requests were sent from.|
|`rwcommunity6 <community string> <IPv6 address>`|Same access as with `rwcommunity` with the difference of using IPv6.|

--------------------
## What is a MIB?

- A **MIB (Management Information Base)** is basically a **dictionary** that defines what each OID means.
- It maps a **numeric OID** â†’ to a **human-readable name** + **data type** + **description**.
- Stored as text files (`.mib`) on your system or provided by vendors.
    

---
## ðŸ”¹ What is an OID?

- An **OID (Object Identifier)** is the actual **address** in the SNMP tree.
- Devices only really _know_ numbers (OIDs).
```
1.3.6.1.2.1.1.1.0 #OID
SNMPv2-MIB::sysDescr.0 #MIB 
```
### TABLE COMPARING MIB TO OID

| MIB (Name form)          | OID (Numeric form)      | Meaning                               |
| ------------------------ | ----------------------- | ------------------------------------- |
| `SNMPv2-MIB::sysDescr.0` | `1.3.6.1.2.1.1.1.0`     | System description (e.g., OS version) |
| `IF-MIB::ifDescr.2`      | `1.3.6.1.2.1.2.2.1.2.2` | Name of interface 2 (`eth0`)          |
| `IF-MIB::ifSpeed.2`      | `1.3.6.1.2.1.2.2.1.5.2` | Speed of interface 2                  |
### MIB:   

- MIB is a text file in which all queryable SNMP objects of a device are listed in a standardized tree hierarchy.
- MIBs do not contain data, but they explain where to find which information and what it looks like, which returns values for the specific OID, or which data type is used.
- It contains at least one `Object Identifier` (`OID`)
For the SNMP client and server to exchange the respective values, the available SNMP objects must have unique addresses known on both sides, which are called `OIDs.`


```shell-session
braa <community string>@<IP>:<.1.3.6.*> 
braa backup@ip:1.3.6.*
```
