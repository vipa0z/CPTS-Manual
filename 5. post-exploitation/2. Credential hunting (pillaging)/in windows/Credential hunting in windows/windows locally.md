


# cheatsheet

lazagne
```
C:\Users\bob\Desktop> start LaZagne.exe all -vv
```
findstr
```
> findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml
```


## Searching the windows file system


## search for directory names like /*ansiblescripts*/

```
Get-ChildItem -Path C:\ -Directory -Recurse -ErrorAction SilentlyContinue |
    Where-Object { $_.Name -like "*ansible*" }
```

## search for Password string
```
Get-ChildItem -Path C:\ -Recurse -Include *.yml -ErrorAction -CaseSensitive SilentlyContinue |
    Select-String -Pattern 'password'
```
- This recursively finds `.yml` files and searches for the string `password`.
    
- Add `-SimpleMatch` to match literally, or `-CaseSensitive` if needed.


```
findstr /S /I /C:"password" C:\*.yml
/S: Recursively searches through subdirectories.

/I: Case-insensitive match.

/C:"password": Searches for the exact string "password".

C:\*.yml: Limits to YAML files typically used by Ansible.
```
#### Key terms to search for

Whether we end up with access to the GUI or CLI, we know we will have some tools to use for searching but of equal importance is what exactly we are searching for. Here are some helpful key terms we can use that can help us discover some credentials:


# gui

### windows search feature

![[WindowsSearch.webp]]
By default, it will search various OS settings and the file system for files and applications containing the key term entered in the search bar.

#### LaZagne

```cmd-session
C:\Users\bob\Desktop> start LaZagne.exe all -vv
```


|Module|Description|
|---|---|
|browsers|Extracts passwords from various browsers including Chromium, Firefox, Microsoft Edge, and Opera|
|chats|Extracts passwords from various chat applications including Skype|
|mails|Searches through mailboxes for passwords including Outlook and Thunderbird|
|memory|Dumps passwords from memory, targeting KeePass and LSASS|
|sysadmin|Extracts passwords from the configuration files of various sysadmin tools like OpenVPN and WinSCP|
|windows|Extracts Windows-specific credentials targeting LSA secrets, Credential Manager, and more|
|wifi|Dumps WiFi credentials|

**Note:** Web browsers are some of the most interestings placed to search for credentials, due to the fact that many of them offer built-in credential storage. In the most popular browsers, such as `Google Chrome`, `Microsoft Edge`, and `Firefox`, stored credentials are encrypted. However, many tools for decrypting the various credentials databases used can be found online, such as [firefox_decrypt](https://github.com/unode/firefox_decrypt) and [decrypt-chrome-passwords](https://github.com/ohyicong/decrypt-chrome-passwords). LaZagne supports `35` different browsers on Windows.
## findstr
```cmd-session
> findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml
```
in case of admin saving his cred of gitlab i tried (basically use ur brain and think what he would save as )
```cmd-session
> findstr /SIM /C:"gitlab" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml
```

# where to look 
Here are some other places we should keep in mind when credential hunting:

- Passwords in Group Policy in the SYSVOL share
- Passwords in scripts in the SYSVOL share
- Password in scripts on IT shares
- Passwords in `web.config` files on dev machines and IT shares
- Password in `unattend.xml`
- Passwords in the AD user or computer description fields
- KeePass databases (if we are able to guess or crack the master password)
- Found on user systems and shares
- Files with names like `pass.txt`, `passwords.docx`, `passwords.xlsx` found on user systems, shares, and [Sharepoint](https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration)