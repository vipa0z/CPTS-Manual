# üõ°Ô∏è Active Directory (AD) Pentesting Checklist



---
## CPTS
---
## 2. Initial Domain Enumeration

### SMB Enumeration
- [ ] Check SMB NULL sessions
- [ ] Run `enum4linux` / `enum4linux-ng`
- [ ] Collect users (`nxc smb --users`, `rpcclient enumdomusers`)
- [ ] Enumerate groups (`rpcclient querygroup`)
- [ ] Gather domain password policy
- [ ] Enumerate RDP sessions
- [ ] Check SYSVOL for readable files

### RPC Enumeration
- [ ] `enumdomusers` via `rpcclient`
- [ ] `rpcclient queryuser <RID>`
- [ ] `rpcclient querygroups <RID>`
- [ ] `rpcdump.py` for RPC endpoint mapping
- [ ] `rpcinfo` for listing RPC services

### LDAP Enumeration
- [ ] Check anonymous bind
- [ ] use `windapsearch` to find **privileged** users and groups
- [ ] run bloodhound-python to gather all data including:
  -  Users info , group info, machine info, session info, ACLs
  - [ ] check if it also returns  policies otherwise use nxc

---
## 3. Password Spraying/ bruting/ password re-use
### User Enumeration & Password Spraying
- [ ] Enumerate usernames via:
  - Statistically Likely Usernames wordlists `jsmith, johnsmih`
- [ ] Generate wordlists (e.g., `cupp`)
- [ ] Apply regex/mutations to match policy
- [ ] Perform password spray (`DomainPasswordSpray`, `kerbrute`, `netexec --continue-on-success`)
---
### Kerberoasting 
- [ ] **bloodhound shows kerberoastable users?**
  - Find accounts with SPNs (`GetUserSPNs.py`, `setspn.exe`)
  - Request TGS tickets
  - Crack hashes and perform password spraying again to check for reuse
---
### AS-REP Roasting:
  - Find users with `no-pre-auth`
  - Request & crack AS-REP hashes
- [ ] Use `Rubeus` for ticket extraction
---
## DACL/ACL Abuse
- [ ] genericAll over a user?
- [ ] use `targetedkerberoast.py` to auto abuse to add an spn and kerberoast a specific user
- [ ]  `Replication get changes(dcsync) privilege` ? dump ntds
# Domain/forest trusts
### parent child trust:
- [ ]  compromise child domain
- [ ] perform SIDHistory attack to create a golden ticket and DCSync
## forest trusts
- [ ] check for kerberoastable users in forest B
- [ ] if you find simillar or the same account in the second forest, Check for  password reuse
- [ ] test password spray in different domains/forests
- [ ] Suppose we can Kerberoast across a trust and have run out of options in the current domain. In that case, it could also be worth attempting a single password spray with the cracked password, as there is a possibility that it could be used for other service accounts if the same admins are in charge of both domains. Here, we have yet another example of iterative testing and leaving no stone unturned.
- [ ] domain local groups
As noted in the last section, we may, from time to time, see users or admins from one domain as members of a group in another domain. Since only `Domain Local Groups` allow users from outside their forest, it is not uncommon to see a highly privileged user from Domain A as a member of the built-in administrators group in domain B
---
## 4. Post-Initial Access Enumeration

- [ ] Run `BloodHound` to map AD relationships
- [ ] Enumerate:
  - Domain Admin groups
  - Nested groups
  - OUs, GPOs, ACLs
  - Local admin rights on machines
  - Domain & forest trusts
- [ ] Run `Group3r` for group policy checks

---

## 5. Lateral Movement

### SMB/NTLM Relay
- [ ] `ntlmrelayx.py` for SMB relay
- [ ] `gpp-decrypt` for GPP credential recovery
- [ ] SCF file drop on writable shares

### Kerberos
- [ ] Check for unconstrained delegation
- [ ] Abuse constrained delegation
- [ ] Golden/Silver ticket attacks
- [ ] Pass-the-Ticket (PtT)
- [ ] Pass-the-Hash (PtH)

### Trust Abuse
- [ ] `raisechild.py` for child‚Üíparent domain pivot
- [ ] SIDHistory attacks for DCSync
- [ ] Check forest trust accounts for reuse

---
## 6. Privilege Escalation

### Windows
- [ ] Run `winPEAS`
- [ ] Run `JAWS`
- [ ] Run `Snaffler` for sensitive files
- [ ] Check LAPS with `LAPSToolkit`
- [ ] Check for vulnerable services/drivers
- [ ] Use `SharpView` / `PowerView` for ACL enumeration

### Linux Privilege escalation
- [ ] Run `linPEAS`
- [ ] Run `LinEnum`
- [ ] Check writable locations:
  - `/dev/shm`
  - `/tmp`
  - `/var/tmp`
  - `/var/spool/vbox`
  - `/var/spool/samba`

---

## 7. Exploits & Vulnerabilities

- [ ] PrintNightmare
- [ ] NoPac
- [ ] EternalBlue
- [ ] PetitPotam
- [ ] ItWasAllADream

---

## 8. extra attacks  ( most of these werent in scope of modules)

- [ ] Log4j scan
- [ ] Spring4Shell scan
- [ ] IKE-scan
- [ ] PRET for printers
---

## 9. Reporting

- [ ] Draft report with findings
- [ ] Include screenshots & PoC
- [ ] Review report for accuracy
- [ ] Submit per engagement rules
